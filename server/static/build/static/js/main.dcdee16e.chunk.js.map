{"version":3,"sources":["hooks/useFetch.js","images/folder-24px.svg","components/scans_list.js","hooks/useModal.js","components/scan/shared.js","components/scan/snapshot.js","components/scan/calibration.js","components/settings_modal.js","components/scan/index.js","app.js","index.js"],"names":["useFetch","url","useState","isLoading","setIsLoading","undefined","response","setResponse","error","setError","options","setOptions","doFetch","useCallback","useEffect","isUnmounted","sendRequest","a","ky","json","name","message","Item","item","isSelected","createdAt","doSelect","className","cx","onClick","data-id","scanId","src","folderSvg","alt","scanType","DeleteButton","onDelete","doDelete","window","confirm","method","alert","btnClassName","loading","type","ScansList","scans","loadScans","selectedScan","selectScan","ev","id","currentTarget","dataset","scan","find","map","useModal","defaultIsOpened","isOpened","setIsOpened","openModal","closeModal","toggleModal","Tab","text","isActive","active","data-tab-name","href","Tabs","children","ClickableImage","filename","props","pathItems","split","length","doDownloadFile","fetch","then","resp","blob","URL","createObjectURL","document","createElement","style","display","download","body","appendChild","click","revokeObjectURL","catch","console","Image","ImagesGrid","images","Component","isClickable","key","ResultImage","Snapshot","activeTab","setActiveTab","selectTab","tabName","position","thumb","result","image","original","undistorted","projected","Calibration","SettingsModal","data","setData","space","replacer","value","Array","JSON","stringify","replace","getIndentedJSON","doSubmit","preventDefault","headers","target","elements","settings","onSubmit","defaultValue","Scan","requestScan","searchParams","timeout","App","setSelectedScan","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.dcdee16e.chunk.js","sourcesContent":["import {useState, useEffect, useCallback} from 'react'\r\nimport ky from 'ky';\r\n\r\n\r\nconst useFetch = (url) => {\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [response, setResponse] = useState(undefined);\r\n    const [error, setError] = useState(undefined);\r\n    const [options, setOptions] = useState({});\r\n\r\n\r\n    const doFetch = useCallback((options = {}) => {\r\n        setOptions(options);\r\n        setIsLoading(true);\r\n        setError(undefined);\r\n    }, []);\r\n\r\n\r\n    useEffect(() => {\r\n        if (!isLoading)\r\n            return;\r\n\r\n        let isUnmounted = false;\r\n\r\n        async function sendRequest() {\r\n            try {\r\n                const json = await ky(url, options).json();\r\n\r\n                if (isUnmounted)\r\n                    return;\r\n\r\n                setResponse(json);\r\n                setIsLoading(false);\r\n            } catch (error) {\r\n                if (isUnmounted)\r\n                    return;\r\n\r\n                if (error.name === 'HTTPError')\r\n                    setError((await error.response.json()).message);\r\n                else\r\n                    setError(error.message);\r\n                setIsLoading(false);\r\n            }\r\n        }\r\n\r\n        sendRequest();\r\n\r\n        return () => {\r\n            isUnmounted = true;\r\n        };\r\n    }, [isLoading, url, options]);\r\n\r\n    return [{isLoading, response, error}, doFetch];\r\n};\r\n\r\n\r\nexport default useFetch;","export default __webpack_public_path__ + \"static/media/folder-24px.075add64.svg\";","import {useCallback, useEffect} from \"react\";\r\nimport cx from 'classnames';\r\nimport folderSvg from \"../images/folder-24px.svg\";\r\nimport useFetch from \"../hooks/useFetch\";\r\n\r\n\r\nconst Item = ({item, createdAt, isSelected, doSelect}) => {\r\n    const className = cx({'text-bold': isSelected});\r\n\r\n    return (\r\n        <li>\r\n            <span className={className} onClick={doSelect} data-id={item.scanId}>\r\n                <img src={folderSvg} alt=\"folder_icon\"/>\r\n                <span>{item.createdAt} ({item.scanType[0]})</span>\r\n            </span>\r\n        </li>\r\n    )\r\n}\r\n\r\nconst DeleteButton = ({onDelete}) => {\r\n    const [{isLoading, response, error}, doFetch] = useFetch(\"/api/scans\");\r\n\r\n    const doDelete = useCallback(() => {\r\n        if (window.confirm('Точно удалить?'))\r\n            doFetch({method: 'DELETE'});\r\n    }, [onDelete]);\r\n\r\n    useEffect(() => {\r\n        if (response)\r\n            onDelete();\r\n        else if (error)\r\n            alert(`Ошибка при удалении: ${error}`);\r\n    }, [response, error]);\r\n\r\n    const btnClassName = cx(\"btn btn-sm btn-primary\", {loading: isLoading});\r\n\r\n    return (\r\n        <button type=\"button\" className={btnClassName} onClick={doDelete}>\r\n            Удалить все\r\n        </button>\r\n    )\r\n}\r\n\r\nconst ScansList = ({scans, loadScans, selectedScan, selectScan}) => {\r\n    const doSelect = useCallback(ev => {\r\n        const id = ev.currentTarget.dataset.id;\r\n        const scan = scans.find(item => item.scanId === id);\r\n        selectScan(scan);\r\n    }, [selectScan, scans]);\r\n\r\n    if (!scans)\r\n        return null;\r\n\r\n    return (\r\n        <div className=\"tree\" id=\"scans-list\">\r\n            <header>\r\n                <DeleteButton onDelete={loadScans} />\r\n            </header>\r\n\r\n            <hr/>\r\n\r\n            <ul>\r\n                {scans.map(item => <Item key={item.scanId}\r\n                                         item={item}\r\n                                         isSelected={item === selectedScan}\r\n                                         doSelect={doSelect}\r\n                />)}\r\n            </ul>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ScansList;","import {useState, useCallback} from 'react'\r\n\r\n\r\nconst useModal = (defaultIsOpened = false) => {\r\n    const [isOpened, setIsOpened] = useState(defaultIsOpened);\r\n\r\n    const openModal = useCallback(() => setIsOpened(true), [setIsOpened]);\r\n    const closeModal = useCallback(() => setIsOpened(false), [setIsOpened]);\r\n    const toggleModal = useCallback(() => setIsOpened(isOpened => !isOpened), [setIsOpened])\r\n\r\n    return {openModal, closeModal, toggleModal, isOpened};\r\n};\r\n\r\nexport default useModal;","import cx from \"classnames\";\r\nimport {useCallback} from \"react\";\r\n\r\nexport const Tab = ({text, isActive, name, onClick}) => {\r\n    const className = cx(\"tab-item text-tiny text-bold text-uppercase\", {active: isActive});\r\n    return (\r\n        <li className={className} data-tab-name={name} onClick={onClick}>\r\n            <a href=\"#\">{text}</a>\r\n        </li>\r\n    )\r\n}\r\n\r\nexport const Tabs = ({children}) => {\r\n    return (\r\n        <ul className=\"tab tab-block\">\r\n            {children}\r\n        </ul>\r\n    )\r\n}\r\n\r\nexport const ClickableImage = ({filename, url, src, alt, ...props}) => {\r\n    alt = alt || src;\r\n    url = url || src;\r\n\r\n    if (!filename && url) {\r\n        const pathItems = url.split('/');\r\n        filename = pathItems[pathItems.length - 1];\r\n    }\r\n\r\n    const doDownloadFile = useCallback(() => {\r\n        fetch(url)\r\n          .then(resp => resp.blob())\r\n          .then(blob => {\r\n            const url = window.URL.createObjectURL(blob);\r\n            const a = document.createElement('a');\r\n            a.style.display = 'none';\r\n            a.href = url;\r\n            a.download = filename;\r\n            document.body.appendChild(a);\r\n            a.click();\r\n            window.URL.revokeObjectURL(url);\r\n          })\r\n          .catch(error => {\r\n              console.error(error);\r\n              alert(error.message);\r\n          });\r\n    }, [url, filename]);\r\n\r\n    return (\r\n        <img className=\"img-responsive clickable c-hand\" src={src} alt={alt} onClick={doDownloadFile} {...props}/>\r\n    )\r\n};\r\n\r\n\r\nconst Image = ({src, alt, ...props}) => {\r\n    alt = alt || src;\r\n\r\n    return (\r\n        <img className=\"img-responsive\" src={src} alt={alt} {...props} />\r\n    )\r\n};\r\n\r\n\r\nexport const ImagesGrid = ({images, isClickable}) => {\r\n    const Component = isClickable ? ClickableImage : Image;\r\n\r\n    const children = ['LU', 'RU', 'LL', 'RL'].map(key =>\r\n        <div key={key} className=\"column col-6\">\r\n            <Component {...images[key]}/>\r\n        </div>\r\n    )\r\n\r\n    return (\r\n        <div className=\"container grid-md\">\r\n            <div className=\"columns\">\r\n                {children}\r\n            </div>\r\n        </div>\r\n    )\r\n}","import {useCallback, useState} from \"react\";\r\nimport {Tab, Tabs, ImagesGrid, ClickableImage} from './shared';\r\n\r\n\r\nconst ResultImage = (props) => {\r\n    return (\r\n        <div className=\"container grid-xs\">\r\n            <ClickableImage {...props}/>\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nconst Snapshot = ({scan}) => {\r\n    const [activeTab, setActiveTab] = useState('result');\r\n    const selectTab = useCallback(ev => setActiveTab(ev.currentTarget.dataset.tabName), [setActiveTab]);\r\n\r\n    const images = {};\r\n    for (const name of ['original', 'undistorted', 'projected']) {\r\n        images[name] = {};\r\n        for (const position of ['LU', 'LL', 'RU', 'RL']) {\r\n            const src = scan.images[name][position].thumb;\r\n            images[name][position] = {src, alt: src};\r\n        }\r\n    }\r\n    images.result = {\r\n        src: scan.images.result.thumb,\r\n        alt: scan.images.result.thumb,\r\n        url: scan.images.result.image,\r\n        filename: `${scan.scanId}_result.jpg`\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <Tabs activeTab={activeTab} selectTab={selectTab}>\r\n                <Tab onClick={selectTab} name=\"original\" text=\"Original\" isActive={activeTab === \"original\"}/>\r\n                <Tab onClick={selectTab} name=\"undistorted\" text=\"Undistorted\" isActive={activeTab === \"undistorted\"}/>\r\n                <Tab onClick={selectTab} name=\"projected\" text=\"Projected\" isActive={activeTab === \"projected\"}/>\r\n                <Tab onClick={selectTab} name=\"result\" text=\"Result\" isActive={activeTab === \"result\"}/>\r\n            </Tabs>\r\n\r\n            {activeTab === \"original\" && <ImagesGrid images={images.original}/>}\r\n            {activeTab === \"undistorted\" && <ImagesGrid images={images.undistorted}/>}\r\n            {activeTab === \"projected\" && <ImagesGrid images={images.projected}/>}\r\n            {activeTab === \"result\" && <ResultImage {...images.result}/>}\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nexport default Snapshot;","import {useCallback, useState} from \"react\";\r\nimport {Tab, Tabs, ImagesGrid} from './shared';\r\n\r\n\r\nconst Calibration = ({scan}) => {\r\n    const [activeTab, setActiveTab] = useState('undistorted');\r\n    const selectTab = useCallback(ev => setActiveTab(ev.currentTarget.dataset.tabName), [setActiveTab]);\r\n\r\n    const images = {};\r\n    for (const name of ['original', 'undistorted']) {\r\n        images[name] = {};\r\n        for (const position of ['LU', 'LL', 'RU', 'RL']) {\r\n            const src = scan.images[name][position].thumb;\r\n            images[name][position] = {src, alt: src};\r\n        }\r\n    }\r\n    for (const position of ['LU', 'LL', 'RU', 'RL'])\r\n        images['undistorted'][position].url = scan.images['undistorted'][position].image;\r\n\r\n    return (\r\n        <div>\r\n            <Tabs activeTab={activeTab} selectTab={selectTab}>\r\n                <Tab onClick={selectTab} name=\"original\" text=\"Original\" isActive={activeTab === \"original\"}/>\r\n                <Tab onClick={selectTab} name=\"undistorted\" text=\"Undistorted\" isActive={activeTab === \"undistorted\"}/>\r\n            </Tabs>\r\n\r\n            {activeTab === \"original\" && <ImagesGrid images={images.original}/>}\r\n            {activeTab === \"undistorted\" && <ImagesGrid images={images.undistorted} isClickable/>}\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nexport default Calibration;","import {useCallback, useEffect, useState} from \"react\";\r\nimport useFetch from \"../hooks/useFetch\";\r\nimport cx from \"classnames\";\r\n\r\n\r\nfunction getIndentedJSON(json, space = 4) {\r\n    const replacer = function(key, value) {\r\n       if (value instanceof Array)\r\n          return JSON.stringify(value);\r\n       return value;\r\n    };\r\n\r\n    return JSON.stringify(json, replacer, space)\r\n        .replace(/\\\"\\[/g, '[')\r\n        .replace(/\\]\\\"/g, ']');\r\n}\r\n\r\n\r\nconst SettingsModal = ({closeModal}) => {\r\n    const [data, setData] = useState();\r\n\r\n    const [{isLoading, response, error}, doFetch] = useFetch('/api/settings');  // for both GET and POST\r\n\r\n    useEffect(doFetch, [doFetch]);\r\n\r\n    useEffect(() => {\r\n        if (response !== undefined && !data) { // GET\r\n            setData(getIndentedJSON(response));\r\n        } else if (response !== undefined && data) // POST\r\n            closeModal();\r\n    }, [response, setData, closeModal]);\r\n\r\n    const doSubmit = useCallback(ev => {\r\n        ev.preventDefault();\r\n\r\n        doFetch({\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: ev.target.elements.settings.value\r\n        });\r\n    }, [doFetch]);\r\n\r\n    const btnClassName = cx(\"btn btn-primary float-right mr-2\", {loading: isLoading});\r\n\r\n    return (\r\n        <form className=\"modal active\" id=\"settings-modal\" onSubmit={doSubmit}>\r\n            <span className=\"modal-overlay\" onClick={closeModal}/>\r\n            <div className=\"modal-container modal-fullheight\">\r\n                <div className=\"modal-header\">\r\n                    <button type=\"button\" className=\"btn btn-link float-right\" onClick={closeModal}>Закрыть</button>\r\n                    <input type=\"submit\" className={btnClassName} value=\"Отправить\"/>\r\n\r\n                    <div className=\"modal-title h5\">Настройки</div>\r\n                </div>\r\n                <ul className=\"mt-0\">\r\n                   <li className=\"mt-0\">\r\n                       Значения table_section_size (миллиметры) напрямую в программе не используются, они здесь для того чтобы были.\r\n                   </li>\r\n                   <li className=\"mt-0\">\r\n                       Значения projected_image_size (пиксели) используются; задаются вручную; должны быть строго пропорциональны значениям table_section_size!\r\n                   </li>\r\n               </ul>\r\n                {error && <div className=\"modal-header pt-0\">\r\n                     <div className=\"toast toast-error\">{error}</div>\r\n                </div>}\r\n                <div className=\"modal-body pt-0\">\r\n                    {data && <textarea name=\"settings\" defaultValue={data} className=\"form-input\"/>}\r\n                    {!data && <div className=\"loading loading-lg\"/>}\r\n                </div>\r\n            </div>\r\n        </form>\r\n    )\r\n};\r\n\r\n\r\nexport default SettingsModal;","import {useCallback, useEffect} from \"react\";\r\nimport useModal from \"../../hooks/useModal\";\r\nimport useFetch from \"../../hooks/useFetch\";\r\nimport Snapshot from './snapshot';\r\nimport Calibration from './calibration';\r\nimport SettingsModal from \"../settings_modal\";\r\n\r\n\r\nconst Scan = ({loadScans, selectedScan}) => {\r\n    const {isOpened, closeModal, openModal} = useModal();\r\n\r\n    const [{isLoading, response, error}, doFetch] = useFetch('/api/scans');\r\n\r\n    const requestScan = useCallback(type => {\r\n        doFetch({method: 'POST', searchParams: {type}, timeout: 50000});\r\n    }, [doFetch]);\r\n\r\n    useEffect(() => {\r\n        if (response)\r\n            alert('Сканирование выполнено');\r\n        else if (error) {\r\n            alert(`Произошла ошибка, сканирование не выполнено: ${error}`);\r\n        }\r\n\r\n        if (response || error)\r\n            loadScans();\r\n    }, [response, error, loadScans]);\r\n\r\n    return (\r\n        <div id=\"scan\">\r\n            <header>\r\n                <button className=\"btn btn-sm btn-primary mr-2\" onClick={() => requestScan('SNAPSHOT')}>\r\n                    Полный скан\r\n                </button>\r\n\r\n                <button className=\"btn btn-sm btn-primary mr-2\" onClick={() => requestScan('CALIBRATION')}>\r\n                    Калибровка точек\r\n                </button>\r\n\r\n                <button type=\"button\" className='btn btn-sm' onClick={openModal}>\r\n                    Настройки\r\n                </button>\r\n            </header>\r\n\r\n            <hr/>\r\n\r\n            {selectedScan?.scanType === \"SNAPSHOT\" && <Snapshot scan={selectedScan}/>}\r\n            {selectedScan?.scanType === \"CALIBRATION\" && <Calibration scan={selectedScan}/>}\r\n            {isOpened && <SettingsModal closeModal={closeModal} />}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Scan;","import {useState, useEffect} from \"react\";\r\nimport useFetch from \"./hooks/useFetch\";\r\n\r\nimport ScansList from \"./components/scans_list\";\r\nimport Scan from \"./components/scan\";\r\n\r\nimport './app.scss';\r\n\r\n\r\n\r\nfunction App() {\r\n    const [selectedScan, setSelectedScan] = useState(null);\r\n\r\n    const [{isLoading, response, error}, loadScans] = useFetch(\"/api/scans\");\r\n\r\n    useEffect(loadScans, [loadScans]);\r\n\r\n    useEffect(() => {\r\n        if (response && response.scans.length > 0)\r\n            setSelectedScan(response.scans[0]);\r\n        else if (error)\r\n            alert(`Ошибка при загрузке списка: ${error}`);\r\n    }, [response, error]);\r\n\r\n    if (isLoading && !response)\r\n        return <div className=\"loading mt-2\"/>;\r\n\r\n    // ------------\r\n\r\n    return (\r\n        <main className=\"container\">\r\n            <div className=\"columns\">\r\n                <div className=\"column col-3\" id=\"column-left\">\r\n                    <ScansList scans={response?.scans} loadScans={loadScans}\r\n                           selectedScan={selectedScan} selectScan={setSelectedScan}\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"divider-vert\"/>\r\n\r\n                <div className=\"column\" id=\"column-right\">\r\n                    <Scan loadScans={loadScans} selectedScan={selectedScan} />\r\n                </div>\r\n            </div>\r\n        </main>\r\n    );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport 'spectre.css/dist/spectre.min.css';\r\nimport 'spectre.css/dist/spectre-icons.min.css';\r\n\r\nimport App from './app';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\n\r\n// import reportWebVitals from './reportWebVitals';\r\n// reportWebVitals(console.log);"],"sourceRoot":""}