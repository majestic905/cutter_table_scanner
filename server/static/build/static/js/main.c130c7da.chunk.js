(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{22:function(e,t,a){},23:function(e,t,a){"use strict";a.r(t);var c=a(0),s=a(1),n=a.n(s),l=a(12),r=a.n(l),i=(a(19),a(20),a(2)),o=a(3),d=a.n(o),j=a(6),b=a(13),u=function(e){var t=Object(s.useState)(!1),a=Object(i.a)(t,2),c=a[0],n=a[1],l=Object(s.useState)(void 0),r=Object(i.a)(l,2),o=r[0],u=r[1],m=Object(s.useState)(void 0),O=Object(i.a)(m,2),x=O[0],f=O[1],v=Object(s.useState)({}),h=Object(i.a)(v,2),g=h[0],p=h[1],N=Object(s.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(e),n(!0),f(void 0)}),[]);return Object(s.useEffect)((function(){if(c){var t=!1;return function(){a.apply(this,arguments)}(),function(){t=!0}}function a(){return(a=Object(j.a)(d.a.mark((function a(){var c;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(b.a)(e,g).json();case 3:if(c=a.sent,!t){a.next=6;break}return a.abrupt("return");case 6:u(c),n(!1),a.next=24;break;case 10:if(a.prev=10,a.t0=a.catch(0),!t){a.next=14;break}return a.abrupt("return");case 14:if("HTTPError"!==a.t0.name){a.next=22;break}return a.t1=f,a.next=18,a.t0.response.json();case 18:a.t2=a.sent.message,(0,a.t1)(a.t2),a.next=23;break;case 22:f(a.t0.message);case 23:n(!1);case 24:case"end":return a.stop()}}),a,null,[[0,10]])})))).apply(this,arguments)}}),[c,e,g]),[{isLoading:c,response:o,error:x},N]},m=a(5),O=a.n(m),x=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(s.useState)(e),a=Object(i.a)(t,2),c=a[0],n=a[1],l=Object(s.useCallback)((function(){return n(!0)}),[n]),r=Object(s.useCallback)((function(){return n(!1)}),[n]),o=Object(s.useCallback)((function(){return n((function(e){return!e}))}),[n]);return{openModal:l,closeModal:r,toggleModal:o,isOpened:c}},f=function(e){var t=e.cameras;return Object(c.jsxs)("div",{id:"cameras",className:"columns",children:[Object(c.jsxs)("div",{className:"column col-6",children:[Object(c.jsx)("label",{className:"form-label text-bold",htmlFor:"camera-LU",children:"LU: Left Upper"}),Object(c.jsx)("textarea",{id:"camera-LU",name:"LU",className:"form-input",defaultValue:t.LU})]}),Object(c.jsxs)("div",{className:"column col-6",children:[Object(c.jsx)("label",{className:"form-label text-bold",htmlFor:"camera-RU",children:"RU: Right Upper"}),Object(c.jsx)("textarea",{id:"camera-RU",name:"RU",className:"form-input",defaultValue:t.RU})]}),Object(c.jsxs)("div",{className:"column col-6",children:[Object(c.jsx)("label",{className:"form-label text-bold",htmlFor:"camera-LL",children:"LL: Left Lower"}),Object(c.jsx)("textarea",{id:"camera-LL",name:"LL",className:"form-input",defaultValue:t.LL})]}),Object(c.jsxs)("div",{className:"column col-6",children:[Object(c.jsx)("label",{className:"form-label text-bold",htmlFor:"camera-RL",children:"RL: Right Lower"}),Object(c.jsx)("textarea",{id:"camera-RL",name:"RL",className:"form-input",defaultValue:t.RL})]})]})},v=function(e){var t=e.closeModal,a=Object(s.useState)(),n=Object(i.a)(a,2),l=n[0],r=n[1],o=u("/api/cameras"),d=Object(i.a)(o,2),j=d[0],b=j.isLoading,m=j.response,x=j.error,v=d[1];Object(s.useEffect)(v,[v]),Object(s.useEffect)((function(){void 0===m||l?void 0!==m&&l&&t():r(m)}),[m,r,t]);var h=Object(s.useCallback)((function(e){e.preventDefault();for(var t={},a=0,c=["LU","LL","RL","RU"];a<c.length;a++){var s=c[a];t[s]=e.target.elements[s].value}v({method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}),[v]),g=O()("btn btn-primary float-right mr-2",{loading:b});return Object(c.jsxs)("form",{className:"modal active",onSubmit:h,children:[Object(c.jsx)("span",{className:"modal-overlay",onClick:t}),Object(c.jsxs)("div",{className:"modal-container modal-fullheight",children:[Object(c.jsxs)("div",{className:"modal-header",children:[Object(c.jsx)("button",{type:"button",className:"btn btn-link float-right",onClick:t,children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"}),Object(c.jsx)("input",{type:"submit",className:g,value:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"}),Object(c.jsx)("div",{className:"modal-title h5",children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"})]}),Object(c.jsxs)("ul",{className:"mt-0",children:[Object(c.jsx)("li",{className:"mt-0",children:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u044f table_section_size (\u043c\u0438\u043b\u043b\u0438\u043c\u0435\u0442\u0440\u044b) \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u0432 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0435 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f, \u043e\u043d\u0438 \u0437\u0434\u0435\u0441\u044c \u0434\u043b\u044f \u0442\u043e\u0433\u043e \u0447\u0442\u043e\u0431\u044b \u0431\u044b\u043b\u0438."}),Object(c.jsx)("li",{className:"mt-0",children:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u044f projected_image_size (\u043f\u0438\u043a\u0441\u0435\u043b\u0438) \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f; \u0437\u0430\u0434\u0430\u044e\u0442\u0441\u044f \u0432\u0440\u0443\u0447\u043d\u0443\u044e; \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0441\u0442\u0440\u043e\u0433\u043e \u043f\u0440\u043e\u043f\u043e\u0440\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\u043c table_section_size!"})]}),x&&Object(c.jsx)("div",{className:"modal-header pt-0",children:Object(c.jsx)("div",{className:"toast toast-error",children:x})}),Object(c.jsxs)("div",{className:"modal-body pt-0",children:[l&&Object(c.jsx)(f,{cameras:l}),b&&Object(c.jsx)("div",{className:"loading loading-lg"})]})]})]})},h=function(e){var t=e.closeModal,a=Object(s.useState)(),n=Object(i.a)(a,2),l=n[0],r=n[1],o=u("/api/lensfun"),d=Object(i.a)(o,2),j=d[0],b=j.isLoading,m=j.response,x=j.error,f=d[1];Object(s.useEffect)(f,[f]),Object(s.useEffect)((function(){void 0===m||l?void 0!==m&&l&&t():r(m.xml)}),[m,r,t]);var v=Object(s.useCallback)((function(e){e.preventDefault(),f({method:"POST",headers:{"Content-Type":"text/plain; charset=utf-8"},body:e.target.elements.lensfun.value})}),[f]),h=O()("btn btn-primary float-right mr-2",{loading:b});return Object(c.jsxs)("form",{className:"modal active",onSubmit:v,children:[Object(c.jsx)("span",{className:"modal-overlay",onClick:t}),Object(c.jsxs)("div",{className:"modal-container modal-fullheight",children:[Object(c.jsxs)("div",{className:"modal-header",children:[Object(c.jsx)("button",{type:"button",className:"btn btn-link float-right",onClick:t,children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"}),Object(c.jsx)("input",{type:"submit",className:h,value:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"}),Object(c.jsx)("div",{className:"modal-title h5",children:"Lensfun XML"})]}),x&&Object(c.jsx)("div",{className:"modal-header pt-0",children:Object(c.jsx)("div",{className:"toast toast-error",children:x})}),Object(c.jsxs)("div",{className:"modal-body pt-0",children:[l&&Object(c.jsx)("textarea",{name:"lensfun",defaultValue:l,className:"form-input"}),!l&&Object(c.jsx)("div",{className:"loading loading-lg"})]})]})]})},g=function(e){var t=e.getScan,a=x(),n=a.isOpened,l=a.closeModal,r=a.openModal,o=x(),d=o.isOpened,j=o.closeModal,b=o.openModal,m=u("/api/scan"),f=Object(i.a)(m,2),g=f[0],p=g.isLoading,N=g.response,L=g.error,k=f[1],C=Object(s.useCallback)((function(e){k({method:"POST",searchParams:{type:e},timeout:5e4})}),[k]);return Object(s.useEffect)((function(){N?alert("\u0421\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e"):L&&alert("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430, \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e: ".concat(L)),(N||L)&&t()}),[N,L,t]),Object(c.jsxs)("header",{className:"navbar",children:[Object(c.jsxs)("section",{className:"navbar-section",children:[Object(c.jsx)("button",{className:O()("btn btn-primary mr-2",{loading:p}),onClick:function(){return C("snapshot")},children:"\u0421\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(c.jsx)("button",{className:O()("btn btn-primary mr-2",{loading:p}),onClick:function(){return C("calibration")},children:"\u041a\u0430\u043b\u0438\u0431\u0440\u043e\u0432\u043a\u0430 \u0442\u043e\u0447\u0435\u043a"}),Object(c.jsx)("button",{type:"button",className:O()("btn mr-2",{loading:p}),onClick:r,children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"}),Object(c.jsx)("button",{type:"button",className:O()("btn",{loading:p}),onClick:b,children:"Lensfun"})]}),n&&Object(c.jsx)(v,{closeModal:l}),d&&Object(c.jsx)(h,{closeModal:j})]})},p=function(e){var t=e.text;return Object(c.jsx)("textarea",{id:"log",className:"form-input",value:t,readOnly:!0})},N=function(e){var t=e.text,a=e.isActive,s=e.name,n=e.onClick,l=O()("tab-item text-bold text-uppercase",{active:a});return Object(c.jsx)("li",{className:l,"data-tab-name":s,onClick:n,children:Object(c.jsx)("a",{href:"#",children:t})})},L=function(e){var t=e.children;return Object(c.jsx)("ul",{className:"tab",children:t})},k=a(4),C=a(11),y=function(e){var t=e.url,a=e.src,s=e.alt,n=e.download,l=Object(C.a)(e,["url","src","alt","download"]);s=s||a,t=t||a;return Object(c.jsx)("img",Object(k.a)({className:"img-responsive clickable c-hand",src:a,alt:s,onClick:function(){var e=document.createElement("a");e.href=t,e.download=n||t.split("/").pop(),document.body.appendChild(e),e.click(),document.body.removeChild(e)}},l))},U=function(e){var t=e.src,a=e.alt,s=Object(C.a)(e,["src","alt"]);return a=a||t,Object(c.jsx)("img",Object(k.a)({className:"img-responsive",src:t,alt:a},s))},R=function(e){var t=e.images,a=e.isClickable?y:U,s=["LU","RU","LL","RL"].map((function(e){return Object(c.jsx)("div",{className:"column col-6",children:Object(c.jsx)(a,Object(k.a)({},t[e]))},e)}));return Object(c.jsx)("div",{className:"container grid-lg images-grid",children:Object(c.jsx)("div",{className:"columns",children:s})})},S=function(e){var t=e.url,a=e.createdAt;return a=new Date(a).toISOString().slice(0,19).replace(/[-:T]/g,"_"),Object(c.jsx)("div",{className:"container grid-lg",children:Object(c.jsx)(y,{src:t,alt:t,url:t,download:"result_".concat(a,".jpg"),id:"result"})})},A=function(e){for(var t=e.scan,a=Object(s.useState)("result"),n=Object(i.a)(a,2),l=n[0],r=n[1],o=Object(s.useCallback)((function(e){return r(e.currentTarget.dataset.tabName)}),[r]),d={original:{},undistorted:{},projected:{},result:t.images.result},j=0,b=["original","undistorted","projected"];j<b.length;j++)for(var u=b[j],m=0,O=["LU","LL","RU","RL"];m<O.length;m++){var x=O[m],f=t.images[u][x],v=f.image,h=f.thumb;d[u][x]={src:"".concat(h,"?").concat(t.createdAt),alt:v,url:v}}return Object(c.jsxs)("div",{children:[Object(c.jsxs)(L,{children:[Object(c.jsx)(N,{onClick:o,name:"original",text:"Original",isActive:"original"===l}),Object(c.jsx)(N,{onClick:o,name:"undistorted",text:"Undistorted",isActive:"undistorted"===l}),Object(c.jsx)(N,{onClick:o,name:"projected",text:"Projected",isActive:"projected"===l}),Object(c.jsx)(N,{onClick:o,name:"result",text:"Result",isActive:"result"===l}),Object(c.jsx)(N,{onClick:o,name:"log",text:"Log",isActive:"log"===l})]}),"original"===l&&Object(c.jsx)(R,{images:d.original,isClickable:!0}),"undistorted"===l&&Object(c.jsx)(R,{images:d.undistorted,isClickable:!0}),"projected"===l&&Object(c.jsx)(R,{images:d.projected,isClickable:!0}),"result"===l&&Object(c.jsx)(S,{url:d.result.image,createdAt:t.createdAt}),"log"===l&&Object(c.jsx)(p,{text:t.log})]})},M=function(e){var t=e.scan,a=Object(s.useState)("undistorted"),n=Object(i.a)(a,2),l=n[0],r=n[1],o=Object(s.useCallback)((function(e){return r(e.currentTarget.dataset.tabName)}),[r]),d={original:{},undistorted:{}};for(var j in d)for(var b=0,u=["LU","LL","RU","RL"];b<u.length;b++){var m=u[b],O=t.images[j][m],x=O.image,f=O.thumb;d[j][m]={src:"".concat(f,"?").concat(t.createdAt),alt:x,url:x}}return Object(c.jsxs)("div",{children:[Object(c.jsxs)(L,{children:[Object(c.jsx)(N,{onClick:o,name:"original",text:"Original",isActive:"original"===l}),Object(c.jsx)(N,{onClick:o,name:"undistorted",text:"Undistorted",isActive:"undistorted"===l}),Object(c.jsx)(N,{onClick:o,name:"log",text:"Log",isActive:"log"===l})]}),"original"===l&&Object(c.jsx)(R,{images:d.original,isClickable:!0}),"undistorted"===l&&Object(c.jsx)(R,{images:d.undistorted,isClickable:!0}),"log"===l&&Object(c.jsx)(p,{text:t.log})]})};a(22);var T=function(){var e=Object(s.useState)(null),t=Object(i.a)(e,2),a=t[0],n=t[1],l=u("/api/scan"),r=Object(i.a)(l,2),o=r[0],d=o.isLoading,j=o.response,b=o.error,m=r[1];return Object(s.useEffect)(m,[m]),Object(s.useEffect)((function(){j?n(j):b&&alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0441\u043a\u0430\u043d\u0430: ".concat(b))}),[j,b]),d?Object(c.jsx)("div",{className:"loading mt-2"}):Object(c.jsxs)("main",{children:[Object(c.jsx)(g,{getScan:m}),"snapshot"===(null===a||void 0===a?void 0:a.scanType)&&Object(c.jsx)(A,{scan:a}),"calibration"===(null===a||void 0===a?void 0:a.scanType)&&Object(c.jsx)(M,{scan:a})]})};r.a.render(Object(c.jsx)(n.a.StrictMode,{children:Object(c.jsx)(T,{})}),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.c130c7da.chunk.js.map